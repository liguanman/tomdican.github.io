<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Mongodb-guide | 多是少</title>
  <meta name="author" content="John Doe">
  
  <meta name="description" content="Step 1 – Adding the MongoDB RepositoryThe mongodb-org package does not exist within the default repositories for CentOS. However, MongoDB maintains a ">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Mongodb-guide"/>
  <meta property="og:site_name" content="多是少"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="多是少" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/css/sidenav.css" media="screen" type="text/css">  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'true']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;

ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';

var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-90489929-1', 'auto');
	    ga('send', 'pageview');
</script>



</head>

<body id="body" data-spy="scroll" data-target=".toc">
  <div class="container" id="container">
	<div class="content">
	  <div class="page-header">		
  <h1><a class="brand" href="/">多是少</a><span class="split"></span><span class="title">Mongodb-guide</span><span class="date" id="title-date"><i class="fa fa-clock-o"></i> 2017-01-20</span></h1>
</div>		

<div class="row page">
  <!-- cols -->	
  
  

  
	<div class="col-md-12">
	  

	  <!-- content -->
	  <h2 id="Step-1-–-Adding-the-MongoDB-Repository"><a href="#Step-1-–-Adding-the-MongoDB-Repository" class="headerlink" title="Step 1 – Adding the MongoDB Repository"></a>Step 1 – Adding the MongoDB Repository</h2><p>The mongodb-org package does not exist within the default repositories for CentOS. However, MongoDB maintains a dedicated repository. Let’s add it to our server.<br>With the vi editor, create a .repo file for yum, the package management utility for CentOS:</p>
<pre><code>* sudo vi /etc/yum.repos.d/mongodb-org.repo
</code></pre><p>Then, visit the Install on Red Hat section of MongoDB’s documentation and add the repository information for the latest stable release to the file:<br>/etc/yum.repos.d/mongodb-org.repo<br>[mongodb-org-3.2]<br>name=MongoDB Repository<br>baseurl=<a href="https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/x86_64/" target="_blank" rel="external">https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.2/x86_64/</a><br>gpgcheck=1<br>enabled=1<br>gpgkey=<a href="https://www.mongodb.org/static/pgp/server-3.2.asc" target="_blank" rel="external">https://www.mongodb.org/static/pgp/server-3.2.asc</a></p>
<p>Save and close the file.<br>Before we move on, we should verify that the MongoDB repository exists within the yum utility. The repolist command displays a list of enabled repositories:</p>
<pre><code>* yum repolist
</code></pre><p>Output<br>. . .<br>repo id                          repo name<br>base/7/x86_64                    CentOS-7 - Base<br>extras/7/x86_64                  CentOS-7 - Extras<br>mongodb-org-3.2/7/x86_64         MongoDB Repository<br>updates/7/x86_64                 CentOS-7 - Updates<br>. . .</p>
<p>With the MongoDB Repository in place, let’s proceed with the installation.</p>
<h2 id="Step-2-–-Installing-MongoDB"><a href="#Step-2-–-Installing-MongoDB" class="headerlink" title="Step 2 – Installing MongoDB"></a>Step 2 – Installing MongoDB</h2><p>We can install the mongodb-org package from the third-party repository using the yum utility.</p>
<pre><code>* sudo yum install mongodb-org
</code></pre><p>There are two Is this ok [y/N]: prompts. The first one permits the installation of the MongoDB packages and the second one imports a GPG key. The publisher of MongoDB signs their software and yum uses a key to confirm the integrity of the downloaded packages. At each prompt, type Y and then press the ENTER key.</p>
<p>Next, start the MongoDB service<br>service mongod start </p>
<p>configuration </p>
<p>vi /etc/mongo.conf</p>
<p>add below:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">security:</div><div class="line">  authorization: enabled</div></pre></td></tr></table></figure></p>
<p> login admin database<br>mongo -u root -p root authenticationDatabase admin</p>
<p>import mongo collection :</p>
<p>mongoimport –db test –collection bookCategory –file bookCategory.json<br>mongoexport –host localhost –port 27017 -u test -p tset –collection bookC ategory   –out bookCategory.json</p>
<h2 id="manage-user"><a href="#manage-user" class="headerlink" title="manage user"></a>manage user</h2><p>MongoDB is a nosql database server. The default installation provides you the access of database using mongo command through command line without authentication. In this tutorial you will learn how to create users in Mongodb server with proper authentications.</p>
<h3 id="Create-Admin-User"><a href="#Create-Admin-User" class="headerlink" title="Create Admin User"></a>Create Admin User</h3><p>You can use below commands to create user with admin privileges in your MongoDB server.<br>$ mongo</p>
<blockquote>
<p>use admin</p>
<p>db.createUser(<br>     {<br>       user:”myadmin”,<br>       pwd:”secret”,<br>       roles:[{role:”root”,db:”admin”}]<br>     }<br>  )</p>
<p>exit</p>
</blockquote>
<p>Now try to connect with above credentials through command line.<br>$ mongo -u myadmin -p  –authenticationDatabase admin</p>
<h3 id="Add-User-for-Database"><a href="#Add-User-for-Database" class="headerlink" title="Add User for Database"></a>Add User for Database</h3><p>You can also create database specific users, that user will have access to that database only. You can also specify access level for that user on database. For example we are creating a user account with read write access on mydb database.</p>
<blockquote>
<p>use mydb</p>
<p>db.createUser(<br>    {<br>      user: “mydbuser”,<br>      pwd: “mydbsecret”,<br>      roles: [“readWrite”]<br>    }<br> ) </p>
<p>exit</p>
</blockquote>
<p>To verify authentication use following command. In result 1 means authentication succeeded.</p>
<blockquote>
<p>db.auth(‘mydbuser’,’mydbsecret’)</p>
</blockquote>
<p>To list all users for a database, use following command.</p>
<blockquote>
<p>db.getUsers()</p>
</blockquote>
<p>Drop User for DatabaseYou may also remove user from database using following command.</p>
<blockquote>
<p>use mydb</p>
<p>db.dropUser(‘mydbuser’)</p>
</blockquote>
<h2 id="use-db"><a href="#use-db" class="headerlink" title="use db"></a>use db</h2><ol>
<li>查看数据库1.1 查看所有数据库与mySQL查看数据库命令一样，MongoDB也是使用show dbs命令查看当前实例中所有的数据库。<blockquote>
<p>show dbs;<br>local         0.328GB<br>test          (empty)</p>
</blockquote>
</li>
</ol>
<p>1.2 查看当前使用数据库要查看当前正在使用的数据库，使用db命令。示例如下：</p>
<blockquote>
<p>db<br>test</p>
</blockquote>
<p>如上所示，进入Mongo shell后，如果未选择（切换）任何数据库，默认工作在test数据库。</p>
<ol>
<li>新建与切换数据库MongoDB新建与切换数据库使用同一个命令use。当数据库存在时，会将工作数据库切换到对应数据库，数据库不存在时，会新建数据库。语法结构如下：<br>use DATABASE_NAME</li>
</ol>
<p>2.1 新建数据库使用use命令新建数据库：</p>
<blockquote>
<p>use newDB<br>switched to db newDB<br>db<br>newDB</p>
</blockquote>
<p>新建的数据库，使用show dbs命令查看不到，要想使用可显示，需要至少插入一个文档：</p>
<blockquote>
<p>show dbs;<br>local         0.328GB<br>test          (empty)<br>db.sites.insert({name:’itbilu.com’})<br>WriteResult({ “nInserted” : 1 })<br>show dbs<br>local         0.328GB<br>newDB         0.078GB<br>test          (empty)</p>
</blockquote>
<p>2.2 切换工作数据库use命令同样可用于切换工作数据库，示例如下：</p>
<blockquote>
<p>use test<br>switched to db test<br>db<br>test</p>
</blockquote>
<ol>
<li>删除数据库db表示对当前使用数据库的引用。删除数据库首先使用use命令切换到要删除的数据库，然后使用db.dropDatabase()命令删除数据库。示例如下：<blockquote>
<p>use newDB<br>switched to db newDB<br>db.dropDatabase()<br>{ “dropped” : “newDB”, “ok” : 1 }<br>show dbs<br>local         0.328GB<br>test          (empty)</p>
</blockquote>
</li>
</ol>
<ol>
<li>查询数据<br>find的第一个参数是查询条件，其形式也是一个文档，决定了要返回哪些文档，空的査询文档{}会匹配集合的全部内容。要是不指定査询文档，默认就是{}，如同SQL中”SELECT * FROM TABLENAME”语句。<br>//将返回集合中所有文档db.collection.find()<br>//或者<br>db.collection.find({})</li>
</ol>
<p>　　第一个参数若为键/值对时，查询过程中就意味着执行了条件筛选，就如同我们使用Linq查询数据库一样。下面查询操作将返回user集合中age键值为16的文档集合。<br>//mongo db<br>db.user.find({age:16})</p>
<p>//Linq to sql<br>dbContext.user.select(p=&gt;p.age==16)</p>
<p>　　上面的查询默认执行“==”操作(就如同linq中 p.age==16)，文档中若存在相同键的值和查询文档中键的值相等的话，就会返回该文档。</p>
	  

	  <div>
  		<center>
		  <div class="pagination">
<ul class="pagination">
	
	
	
	
	
	
		
			
			
		
	
		
			
			
			
		
	
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
	
	
		<li class="prev disabled"><a><i class="fa fa-arrow-circle-o-left"></i>prev</a></li>
	
	<li><a href="/"><i class="fa fa-archive"></i>Home</a></li>
	
		<li class="next"><a href="/2017/01/20/git-guide/" class="alignright next">next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

		</center>
	  </div>
	  
	</div> <!-- col-md-9/col-md-12 -->
	
  </div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
	<footer> <p>
      <!-- <a href="/atom.xml">rss</a>
      <span class="split"></span>
      <a href="https://github.com/tomdican/tomdican.github.io">github</a>    
      <span class="split"></span>
      -->
      <span id="busuanzi_value_site_pv"></span> hits.
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>.
      Theme by <a href="http://github.com/wzpan/hexo-theme-wixo/">Wixo</a>.    

</p>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
 </footer>
  </div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.tableofcontents.min.js"></script>
<script src="/js/tocgenerator.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


</body>
</html>
